import streamlit as st
import numpy as np
import pandas as pd

# ğŸŒ¸ í˜ì´ì§€ ì„¤ì •
st.set_page_config(page_title="ìœ ë¦¬í•¨ìˆ˜ì˜ ê°œë…ê³¼ ì„±ì§ˆ", page_icon="ğŸŒ¸", layout="wide")

# ğŸŒ¸ CSS í…Œë§ˆ
st.markdown("""
<style>
    body {
        background-color: #fff5f8;
    }
    .stApp {
        background: linear-gradient(180deg, #ffe6f0 0%, #fff 80%);
        color: #333;
        font-family: 'Apple SD Gothic Neo', sans-serif;
    }
    h1, h2, h3 {
        color: #ff66a3;
    }
    .stTabs [data-baseweb="tab"] {
        background-color: #ffe6f0;
        color: #333;
        border-radius: 10px;
        margin-right: 4px;
        padding: 6px 14px;
        font-weight: 600;
    }
</style>
""", unsafe_allow_html=True)

# ğŸŒ¸ ì œëª©
st.title("ğŸŒ¸ ìœ ë¦¬í•¨ìˆ˜ì˜ ê°œë…ê³¼ ì„±ì§ˆ êµê³¼ì„œ ğŸŒ¸")
st.write("ì•„ë˜ ë‹¨ê³„ë¥¼ í•˜ë‚˜ì”© ëˆŒëŸ¬ë³´ë©° ìœ ë¦¬í•¨ìˆ˜ë¥¼ ë°°ì›Œë´ìš”!")

# íƒ­ êµ¬ì„±
tabs = st.tabs(["1ï¸âƒ£ ê°œë… ì´í•´", "2ï¸âƒ£ ê·¸ë˜í”„ íƒêµ¬", "3ï¸âƒ£ ì„±ì§ˆ ì •ë¦¬", "4ï¸âƒ£ ë¬¸ì œë¡œ í™•ì¸í•˜ê¸°"])

# 1ï¸âƒ£ ê°œë… ì´í•´
with tabs[0]:
    st.header("ğŸ”¹ ë‹¤í•­í•¨ìˆ˜ì™€ ìœ ë¦¬í•¨ìˆ˜ì˜ êµ¬ë¶„")
    st.markdown("""
    **ë‹¤í•­í•¨ìˆ˜ (Polynomial Function)**  
    - xê°€ ë¶„ëª¨ì— ì—†ëŠ” í•¨ìˆ˜  
    - ì˜ˆ: \\( f(x) = 2x^2 + 3x - 1 \\)

    **ìœ ë¦¬í•¨ìˆ˜ (Rational Function)**  
    - ë‹¤í•­í•¨ìˆ˜ì˜ **ë¹„(åˆ†)** ë¡œ ì´ë£¨ì–´ì§„ í•¨ìˆ˜  
    - ì˜ˆ: \\( f(x) = \\frac{p(x)}{q(x)}, \\quad q(x) \\neq 0 \\)  
      â†’ \\( f(x) = \\frac{1}{x},\\  \\frac{x+2}{x-1} \\)

    ğŸ’¡ **í•µì‹¬ ì°¨ì´ì :** ë¶„ëª¨ì— xê°€ ìˆìœ¼ë©´ â€˜ìœ ë¦¬í•¨ìˆ˜â€™!
    """)

# 2ï¸âƒ£ ê·¸ë˜í”„ íƒêµ¬
with tabs[1]:
    st.header("ğŸ”¹ ìœ ë¦¬í•¨ìˆ˜ì˜ ê¸°ë³¸í˜•ê³¼ ê·¸ë˜í”„ ë³€í™”")

    st.markdown("""
    ìœ ë¦¬í•¨ìˆ˜ì˜ ê¸°ë³¸í˜•ì€  
    \\[
    f(x) = \\frac{1}{x}
    \\]
    ì…ë‹ˆë‹¤.
    """)

    x = np.linspace(-10, 10, 400)
    x = x[x != 0]
    df = pd.DataFrame({"x": x, "y": 1/x})
    st.line_chart(df, x="x", y="y", height=400)

    st.markdown("""
    ğŸ“ **y=1/x** â†’ 1, 3ì‚¬ë¶„ë©´  
    ğŸ“ **y=-1/x** â†’ 2, 4ì‚¬ë¶„ë©´  
    """)

    st.subheader("âš™ï¸ ê·¸ë˜í”„ ì¡°ì ˆí•´ë³´ê¸°")
    a = st.slider("a (ê¸°ìš¸ê¸°/ë°©í–¥)", -3.0, 3.0, 1.0, step=0.5)
    p = st.slider("p (xì¶• ì´ë™)", -5.0, 5.0, 0.0, step=0.5)
    q = st.slider("q (yì¶• ì´ë™)", -5.0, 5.0, 0.0, step=0.5)
    abs_mode = st.checkbox("ì ˆëŒ“ê°’ |x| ì ìš© (y = 1/|x|)")

    x2 = np.linspace(-10, 10, 400)
    x2 = x2[x2 != p]
    if abs_mode:
        y2 = a / np.abs(x2 - p) + q
    else:
        y2 = a / (x2 - p) + q
    df2 = pd.DataFrame({"x": x2, "y": y2})
    st.line_chart(df2, x="x", y="y", height=400)

    st.markdown("""
    ğŸ”¸ **í‰í–‰ì´ë™**  
    - `p`: xì¶• ë°©í–¥ ì´ë™  
    - `q`: yì¶• ë°©í–¥ ì´ë™  

    ğŸ”¸ **ì ˆëŒ“ê°’ |x| ì ìš© ì‹œ**  
    - yì¶• ëŒ€ì¹­ í˜•íƒœë¡œ ê·¸ë˜í”„ ë³€í™”!
    """)

# 3ï¸âƒ£ ì„±ì§ˆ ì •ë¦¬
with tabs[2]:
    st.header("ğŸ”¹ ìœ ë¦¬í•¨ìˆ˜ì˜ ì£¼ìš” ì„±ì§ˆ ì •ë¦¬")
    st.markdown("""
    | êµ¬ë¶„ | ë‚´ìš© |
    |------|------|
    | **ì •ì˜ì—­** | ë¶„ëª¨ê°€ 0ì´ ë˜ëŠ” x ì œì™¸ |
    | **ì ê·¼ì„ ** | ë¶„ëª¨ê°€ 0ì´ ë˜ëŠ” x=p, ìˆ˜í‰ ì ê·¼ì„  y=q |
    | **ëŒ€ì¹­ì„±** | y=1/x ëŠ” ì›ì  ëŒ€ì¹­ |
    | **ì ˆëŒ“ê°’ ì ìš© ì‹œ** | yì¶• ëŒ€ì¹­ í˜•íƒœë¡œ ë³€í•¨ |

    ğŸ’¡ **ê·¸ë˜í”„ì˜ ê¸°ë³¸í˜• `y = 1/x` ëŠ” ì›ì ì„ ê¸°ì¤€ìœ¼ë¡œ ì¢Œìš° ëŒ€ì¹­ì´ì—ìš”.**
    """)

# 4ï¸âƒ£ ë¬¸ì œë¡œ í™•ì¸í•˜ê¸°
with tabs[3]:
    st.header("ğŸ§© ë” ì•Œì•„ë³´ê¸° - ê°œë… í™•ì¸ ë¬¸ì œ")
    st.write("ê°ê´€ì‹ ë¬¸ì œë¥¼ í’€ë©´ì„œ ê°œë…ì„ ì •ë¦¬í•´ë´ìš”!")

    questions = [
        {"q": "1. ë‹¤ìŒ ì¤‘ ìœ ë¦¬í•¨ìˆ˜ê°€ ì•„ë‹Œ ê²ƒì€?", 
         "choices": ["â‘  y=1/x", "â‘¡ y=(x+1)/(x-2)", "â‘¢ y=xÂ²+1", "â‘£ y=2/x", "â‘¤ y=(xÂ²+1)/x"], "answer": "â‘¢ y=xÂ²+1"},
        {"q": "2. y=1/x ê·¸ë˜í”„ëŠ” ì–´ëŠ ì‚¬ë¶„ë©´ì— ìˆì„ê¹Œ?", 
         "choices": ["â‘  1,3ì‚¬ë¶„ë©´", "â‘¡ 2,4ì‚¬ë¶„ë©´", "â‘¢ 1,2ì‚¬ë¶„ë©´", "â‘£ 3,4ì‚¬ë¶„ë©´", "â‘¤ ëª¨ë“  ì‚¬ë¶„ë©´"], "answer": "â‘  1,3ì‚¬ë¶„ë©´"},
        {"q": "3. y=-1/x ê·¸ë˜í”„ëŠ” ì–´ëŠ ì‚¬ë¶„ë©´ì— ìˆì„ê¹Œ?", 
         "choices": ["â‘  1,3ì‚¬ë¶„ë©´", "â‘¡ 2,4ì‚¬ë¶„ë©´", "â‘¢ 1,2ì‚¬ë¶„ë©´", "â‘£ 3,4ì‚¬ë¶„ë©´", "â‘¤ ì—†ìŒ"], "answer": "â‘¡ 2,4ì‚¬ë¶„ë©´"},
        {"q": "4. y=1/(x-2)+3 ì˜ ì ê·¼ì„ ì€?", 
         "choices": ["â‘  x=0,y=0", "â‘¡ x=2,y=3", "â‘¢ x=-2,y=3", "â‘£ x=3,y=2", "â‘¤ x=3,y=-2"], "answer": "â‘¡ x=2,y=3"},
        {"q": "5. y=a/x ì—ì„œ a<0 ì¼ ë•Œ, ê·¸ë˜í”„ëŠ”?", 
         "choices": ["â‘  1,3ì‚¬ë¶„ë©´", "â‘¡ 2,4ì‚¬ë¶„ë©´", "â‘¢ xì¶• ëŒ€ì¹­", "â‘£ yì¶• ëŒ€ì¹­", "â‘¤ ì›ì  í†µê³¼"], "answer": "â‘¡ 2,4ì‚¬ë¶„ë©´"},
        {"q": "6. ì ˆëŒ“ê°’ì´ í¬í•¨ëœ y=1/|x| ì˜ ê·¸ë˜í”„ëŠ”?", 
         "choices": ["â‘  1,2ì‚¬ë¶„ë©´", "â‘¡ 2,4ì‚¬ë¶„ë©´", "â‘¢ 1,3ì‚¬ë¶„ë©´", "â‘£ 3,4ì‚¬ë¶„ë©´", "â‘¤ ì—†ìŒ"], "answer": "â‘  1,2ì‚¬ë¶„ë©´"},
        {"q": "7. ìœ ë¦¬í•¨ìˆ˜ì˜ ì ê·¼ì„ ì€ í‰í–‰ì´ë™ í›„ ì–´ë–»ê²Œ ë³€í•˜ë‚˜?", 
         "choices": ["â‘  ë³€í•˜ì§€ ì•ŠëŠ”ë‹¤", "â‘¡ x=p, y=q ë¡œ ì´ë™", "â‘¢ xì¶•ë§Œ ì´ë™", "â‘£ yì¶•ë§Œ ì´ë™", "â‘¤ ëŒ€ì¹­ë§Œ ë³€í•¨"], "answer": "â‘¡ x=p, y=q ë¡œ ì´ë™"}
    ]

    for i, q in enumerate(questions):
        st.markdown(f"**{q['q']}**")
        ans = st.radio("ë³´ê¸°", q["choices"], key=f"quiz_{i}")
        if st.button(f"ì •ë‹µ í™•ì¸ ({i+1}ë²ˆ)"):
            if ans == q["answer"]:
                st.success("ğŸ‰ ì •ë‹µì…ë‹ˆë‹¤!")
            else:
                st.error(f"âŒ ì˜¤ë‹µì…ë‹ˆë‹¤. ì •ë‹µì€ {q['answer']} ì…ë‹ˆë‹¤.")

    st.markdown("---")
    st.markdown("<h2 style='text-align:center; color:#ff66a3;'>ğŸ’– ê³ ìƒí•˜ì…¨ìŠµë‹ˆë‹¤~ ì‚¬ë‘í•´ìš” ğŸ’–</h2>", unsafe_allow_html=True)
